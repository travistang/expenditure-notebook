(this["webpackJsonpexpenditure-notebook"]=this["webpackJsonpexpenditure-notebook"]||[]).push([[0],{26:function(e,t,n){},33:function(e,t,n){},39:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),c=n(18),o=n.n(c),s=(n(26),n(3)),l=n(9),i=n(6),u=n(0);function d(e){var t=e.value,n=e.onChange,r=a.a.useRef(null),c="".concat((t/100).toFixed(2),"\u20ac"),o=window.screen.width;return Object(u.jsx)("input",{ref:r,style:{fontSize:1.5*o/c.length},className:"digit center text-color-100 bg-primary-500 text-center",value:c,type:"tel",onKeyDown:function(e){var r=e.key,a=parseInt(r);Number.isNaN(a)||n(10*t+a),"Backspace"===r&&n(Math.floor(t/10))}})}var b,j=n(5),p=n(8);function x(e){var t=e.currentPage,n=e.goPage,r=t===b.HOME_PAGE?b.RECORD_LIST_PAGE:b.HOME_PAGE,a=r===b.HOME_PAGE?j.a:j.b;return Object(u.jsxs)("header",{className:"h-16 flex-0 center relative",children:[Object(u.jsx)("span",{className:"uppercase text-lg",children:"Expenditure logbook"}),Object(u.jsx)("div",{className:"absolute right-0 top-0 h-full horizontal-center gap-4 text-xl",children:Object(u.jsx)(p.a,{icon:a,onClick:function(){return n(r)},className:"cursor-pointer"})})]})}!function(e){e[e.HOME_PAGE=0]="HOME_PAGE",e[e.RECORD_LIST_PAGE=1]="RECORD_LIST_PAGE"}(b||(b={}));n(33);var f=n(10),h=n.n(f);function v(e){var t=e.children,n=e.className,r=e.name,a=e.label,c=e.value,o=e.onChange;return Object(u.jsxs)("div",{className:"vertical gap-1",children:[Object(u.jsx)("label",{htmlFor:r,children:a}),Object(u.jsxs)("div",{className:h()("rounded-lg bg-primary-200 p-4 horizontal",n),children:[t,Object(u.jsx)("input",{className:"bg-primary-200 w-full outline-none text-2xl",value:c,onChange:function(e){return o(e.target.value)}})]})]})}function m(e){var t=e.onOpenUploadModal,n=e.onSubmit;return Object(u.jsxs)("div",{className:"h-1/6 md:h-1/3 center w-full relative",children:[Object(u.jsx)("button",{onClick:n,className:"h-20 w-20 md:h-96 md:w-96 rounded-full bg-secondary-500 text-xl md:text-7xl",children:Object(u.jsx)(p.a,{icon:j.c})}),Object(u.jsx)("div",{className:"absolute right-0 top-0 h-full horizontal-center gap-2",children:Object(u.jsx)("button",{onClick:t,className:"text-3xl md:text-7xl rounded-full center h-12 w-12 bg-color-50 text-primary-500",children:Object(u.jsx)(p.a,{icon:j.d,className:"text-primary-500"})})})]})}function O(e){var t=e.text,n=e.onDelete;return Object(u.jsxs)("div",{onClick:n,className:"horizontal-center px-2 py-1 rounded-md bg-primary-100 text-sm text-color-100",children:[Object(u.jsx)("span",{className:"pr-1",children:t}),Object(u.jsx)(p.a,{icon:j.e,className:"pl-1 w-8 h-8"})]})}function g(e){var t=e.name,n=e.label,r=e.values,c=e.onChange,o=e.selectableOptions,s=void 0===o?[]:o,d=a.a.useState(""),b=Object(i.a)(d,2),j=b[0],p=b[1],x=function(e){var t=e||j;t&&(r.find((function(e){return e.toLowerCase()===t.toLowerCase()}))||(c([].concat(Object(l.a)(r),[t])),p("")))},f=function(e){return function(){c(r.filter((function(t){return t!==e})))}},v=j.length<2?[]:s.filter((function(e){return e.toLowerCase().includes(j.toLowerCase())&&!r.find((function(t){return t.toLowerCase()===e.toLowerCase()}))})).sort().slice(0,5);return Object(u.jsxs)("div",{className:"vertical gap-1",children:[Object(u.jsx)("label",{htmlFor:t,children:n}),Object(u.jsxs)("div",{className:h()("relative rounded-lg bg-primary-200 p-4 horizontal","gap-2"),children:[r.map((function(e){return Object(u.jsx)(O,{text:e,onDelete:f(e)},e)})),Object(u.jsx)("input",{onKeyDown:function(e){"Enter"===e.key&&x(),"Backspace"===e.key&&0===j.length&&r.length>0&&f(r[r.length-1])()},className:"bg-primary-200 w-full outline-none text-2xl",value:j,onChange:function(e){return p(e.target.value)}}),v&&Object(u.jsx)("div",{className:"absolute min-h-20 bg-primary-200 rounded-lg left-0 right-0 top-full mt-2 overflow-y-scroll",children:v.map((function(e){return Object(u.jsx)("div",{onClick:function(){return x(e)},className:"cursor-pointer px-2 h-12 whitespace-nowrap overflow-ellipsis horizontal-center hover:bg-primary-700",children:e},e)}))})]})]})}var w={expenditures:[]},N="ls/expenditure",y=a.a.createContext({store:w,addExpenditure:function(e){}});function C(e){var t=e.children,n=function(e){try{var t=JSON.parse(localStorage.getItem(N)||"")||w;return e?e.split(".").reduce((function(e,t){return null===e||void 0===e?void 0:e[t]}),t):t}catch(n){return null}}()||{expenditures:[]},r=a.a.useState(n),c=Object(i.a)(r,2),o=c[0],d=c[1];a.a.useEffect((function(){var e;o&&(e=o,localStorage.setItem(N,JSON.stringify(e)))}),[o]);var b={store:o,addExpenditure:function(e){d(Object(s.a)(Object(s.a)({},o),{},{expenditures:[].concat(Object(l.a)(o.expenditures),[e])}))}};return Object(u.jsx)(y.Provider,{value:b,children:t})}var E=n(7),S=n(42);function k(){var e,t=a.a.useContext(y).store;return Object(u.jsx)("div",{className:"vertical flex-1 overflow-y-scroll",children:null===t||void 0===t||null===(e=t.expenditures)||void 0===e?void 0:e.map((function(e){return Object(u.jsxs)("div",{className:"flex-shrink-0 items-center grid grid-cols-12 h-16 border-t border-b border-primary-200",children:[Object(u.jsx)("span",{className:"col-span-3",children:Object(S.a)(new Date(e.date),"yyyy-MM-dd HH:mm")}),Object(u.jsx)("span",{className:"col-span-6 whitespace-nowrap overflow-hidden overflow-ellipsis",children:e.description}),Object(u.jsxs)("span",{className:"col-span-3 whitespace-nowrap overflow-hidden overflow-ellipsis",children:[e.amount,"\u20ac"]})]})}))})}var P=n(17),_=n.n(P),M=n(19),A=n(20),D=n.n(A);function L(e){var t=e.children,n=e.title,r=e.opened,a=e.onClose,c=e.className;return r?Object(u.jsx)("div",{className:"fixed z-10 inset-0 p-4 center bg-color-700 bg-opacity-60",onClick:a,children:Object(u.jsxs)("div",{onClick:function(e){return e.stopPropagation()},className:h()("rounded-lg w-full bg-primary-300 text-color-100 vertical overflow-y-scroll",c||"h-2/3 p-2"),children:[Object(u.jsx)("span",{className:"uppercase font-bold text-md text-color-100 mb-2",children:n}),t]})}):null}function G(e){var t=e.opened,n=e.onClose,r=a.a.useContext(y).store,c=function(){var e=Object(M.a)(_.a.mark((function e(t){var a,c;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=19;break}if((null===(a=JSON.parse(t))||void 0===a?void 0:a.url)&&(null===a||void 0===a?void 0:a.key)){e.next=4;break}throw new Error;case 4:return e.prev=4,e.next=7,fetch(a.url,{method:"POST",body:JSON.stringify(r)});case 7:return c=e.sent,e.next=10,c.json();case 10:e.sent,E.b.success("Code detected"),n(),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(4),console.log(e.t0),E.b.error(e.t0.message);case 19:case"end":return e.stop()}}),e,null,[[4,15]])})));return function(t){return e.apply(this,arguments)}}();return Object(u.jsxs)(L,{title:"Upload record",opened:t,onClose:n,children:[Object(u.jsx)("span",{className:"text-sm font-bold text-color-300 leading-4",children:"Upload expenditure records on this device to server by sending its QR code."}),Object(u.jsx)(D.a,{className:"mt-4 rounded-lg w-full overflow-hidden",onError:function(e){var t;E.b.error(null!==(t=null===e||void 0===e?void 0:e.message)&&void 0!==t?t:"Error with QR code")},onScan:c})]})}var R={amount:0,description:"",labels:[]};function H(){var e=a.a.useState(b.HOME_PAGE),t=Object(i.a)(e,2),n=t[0],r=t[1],c=a.a.useContext(y),o=c.addExpenditure,j=c.store,p=a.a.useState(R),f=Object(i.a)(p,2),h=f[0],O=f[1],w=a.a.useState(!1),N=Object(i.a)(w,2),C=N[0],S=N[1],P=j.expenditures.reduce((function(e,t){return Array.from(new Set([].concat(Object(l.a)(e),Object(l.a)(t.labels))))}),[]);return Object(u.jsxs)("div",{className:"absolute vertical inset-0 flex p-4 bg-primary-500 overflow-hidden",children:[Object(u.jsx)(E.a,{}),Object(u.jsx)(G,{opened:C,onClose:function(){return S(!1)}}),Object(u.jsx)(x,{currentPage:n,goPage:r}),n===b.HOME_PAGE&&Object(u.jsxs)("div",{className:"flex-1 vertical overflow-hidden",children:[Object(u.jsx)(d,{value:h.amount,onChange:function(e){return O(Object(s.a)(Object(s.a)({},h),{},{amount:e}))}}),Object(u.jsx)(v,{name:"description",label:"description",value:h.description,onChange:function(e){return O(Object(s.a)(Object(s.a)({},h),{},{description:e}))}}),Object(u.jsx)(g,{name:"labels",label:"tags",values:h.labels,onChange:function(e){return O(Object(s.a)(Object(s.a)({},h),{},{labels:e}))},selectableOptions:P}),Object(u.jsx)("div",{className:"flex-1"}),Object(u.jsx)(m,{onOpenUploadModal:function(){return S(!0)},onSubmit:function(){h.amount<=0||!h.description?E.b.error("missing description or amount is invalid."):(o(Object(s.a)(Object(s.a)({},h),{},{amount:h.amount/100,date:new Date,id:"".concat((new Date).getTime(),"-").concat(Math.random().toString().split(".")[1])})),O(R),E.b.success("Expenditure logged!"))}})]}),n===b.RECORD_LIST_PAGE&&Object(u.jsx)(k,{})]})}function I(){return Object(u.jsx)(C,{children:Object(u.jsx)(H,{})})}var z=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,43)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),r(e),a(e),c(e),o(e)}))};o.a.render(Object(u.jsx)(a.a.StrictMode,{children:Object(u.jsx)(I,{})}),document.getElementById("root")),z()}},[[39,1,2]]]);
//# sourceMappingURL=main.54a6546d.chunk.js.map