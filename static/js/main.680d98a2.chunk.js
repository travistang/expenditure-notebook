(this["webpackJsonpexpenditure-notebook"]=this["webpackJsonpexpenditure-notebook"]||[]).push([[0],{30:function(e,t,n){},38:function(e,t,n){},44:function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),a=n(21),c=n.n(a),s=(n(30),n(6)),i=n(13),l=n(10),u=n(0);function d(e){var t=e.value,n=e.onChange,r=o.a.useRef(null),a="".concat((t/100).toFixed(2),"\u20ac"),c=window.screen.width;return Object(u.jsx)("input",{ref:r,style:{fontSize:1.5*c/a.length},className:"digit center text-color-100 bg-primary-700 text-center",value:a,type:"tel",onKeyDown:function(e){var r=e.key,o=parseInt(r);Number.isNaN(o)||n(10*t+o),"Backspace"===r&&n(Math.floor(t/10))}})}var b,j=n(8),x=n(9);!function(e){e[e.HOME_PAGE=0]="HOME_PAGE",e[e.RECORD_LIST_PAGE=1]="RECORD_LIST_PAGE"}(b||(b={}));var p=n(22),f=n.n(p),v=n(11),m={expenditures:[]},h="ls/expenditure",O=o.a.createContext({store:m,addExpenditure:function(e){}});function g(e){var t=e.children,n=function(e){try{var t=JSON.parse(localStorage.getItem(h)||"")||m;return e?e.split(".").reduce((function(e,t){return null===e||void 0===e?void 0:e[t]}),t):t}catch(n){return null}}()||{expenditures:[]},r=o.a.useState(n),a=Object(l.a)(r,2),c=a[0],d=a[1];o.a.useEffect((function(){var e;c&&(e=c,localStorage.setItem(h,JSON.stringify(e)))}),[c]);var b={store:c,addExpenditure:function(e){d(Object(s.a)(Object(s.a)({},c),{},{expenditures:[].concat(Object(i.a)(c.expenditures),[e])}))}};return Object(u.jsx)(O.Provider,{value:b,children:t})}var w=n(12),y=n.n(w);function N(e){var t=e.children,n=e.title,r=e.opened,o=e.onClose,a=e.className;return r?Object(u.jsx)("div",{className:"fixed z-10 inset-0 p-4 center bg-color-700 bg-opacity-60",onClick:o,children:Object(u.jsxs)("div",{onClick:function(e){return e.stopPropagation()},className:y()("rounded-lg w-full bg-primary-600 text-color-100 vertical overflow-y-auto",a||"h-2/3 p-2"),children:[Object(u.jsx)("span",{className:"uppercase font-bold text-md text-color-100 mb-2",children:n}),t]})}):null}function C(e){var t=e.opened,n=e.onClose,r=o.a.useContext(O).store;return Object(u.jsxs)(N,{title:"Copy store content to clipboard",opened:t,onClose:n,children:[Object(u.jsx)("textarea",{id:"store-text",className:"shadow-inner rounded-lg bg-primary-700 code digit flex-1 resize-none",value:JSON.stringify(r),contentEditable:!1}),Object(u.jsx)("div",{className:"h-16 py-2 flex items-center justify-end",children:Object(u.jsxs)("button",{type:"button",onClick:function(){f()(JSON.stringify(r)),v.b.success("Copied store value to clipboard!")},className:"rounded-lg bg-secondary-500 gap-2 flex items-center p-2 h-full hover:bg-secondary-600",children:[Object(u.jsx)(x.a,{icon:j.a}),"Copy to clipboard"]})})]})}function E(e){var t=e.currentPage,n=e.goPage,r=t===b.HOME_PAGE?b.RECORD_LIST_PAGE:b.HOME_PAGE,a=r===b.HOME_PAGE?j.b:j.c,c=o.a.useState(!1),s=Object(l.a)(c,2),i=s[0],d=s[1];return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)("header",{className:"h-16 flex-0 center relative",children:[Object(u.jsx)("span",{className:"uppercase text-lg",children:"Expenditure logbook"}),Object(u.jsxs)("div",{className:"absolute right-0 top-0 h-full horizontal-center gap-4 text-xl",children:[Object(u.jsx)(x.a,{icon:j.a,className:"cursor-pointer",onClick:function(){return d(!0)}}),Object(u.jsx)(x.a,{icon:a,onClick:function(){return n(r)},className:"cursor-pointer"})]})]}),Object(u.jsx)(C,{opened:i,onClose:function(){return d(!1)}})]})}n(38);function k(e){var t=e.children,n=e.className,r=e.name,o=e.label,a=e.value,c=e.onChange;return Object(u.jsxs)("div",{className:"vertical gap-1",children:[Object(u.jsx)("label",{htmlFor:r,children:o}),Object(u.jsxs)("div",{className:y()("rounded-lg bg-primary-500 p-4 horizontal",n),children:[t,Object(u.jsx)("input",{className:"h-4 bg-primary-500 text-primary-100 w-full outline-none text-xl",value:a,onChange:function(e){return c(e.target.value)}})]})]})}function S(e){var t=e.onOpenUploadModal,n=e.onSubmit;return Object(u.jsxs)("div",{className:"h-1/6 md:h-1/3 center w-full relative",children:[Object(u.jsx)("button",{onClick:n,className:"h-20 w-20 md:h-96 md:w-96 rounded-full bg-secondary-500 text-xl md:text-7xl",children:Object(u.jsx)(x.a,{icon:j.d})}),Object(u.jsx)("div",{className:"absolute right-0 top-0 h-full horizontal-center gap-2",children:Object(u.jsx)("button",{onClick:t,className:"text-3xl md:text-7xl rounded-full center h-12 w-12 bg-color-50 text-primary-700",children:Object(u.jsx)(x.a,{icon:j.e,className:"text-primary-700"})})})]})}function P(e){var t=e.text,n=e.onDelete;return Object(u.jsxs)("div",{onClick:n,className:"horizontal-center px-2 py-1 rounded-md bg-primary-500 text-sm text-color-100",children:[Object(u.jsx)("span",{className:"pr-1",children:t}),Object(u.jsx)(x.a,{icon:j.f,className:"pl-1 w-8 h-8"})]})}function D(e){var t,n,r=e.name,a=e.label,c=e.values,s=e.onChange,d=e.selectableOptions,b=void 0===d?[]:d,j=o.a.useRef(null),x=o.a.useState(""),p=Object(l.a)(x,2),f=p[0],v=p[1],m=function(e){var t=e||f;t&&(c.find((function(e){return e.toLowerCase()===t.toLowerCase()}))||(s([].concat(Object(i.a)(c),[t])),v("")))},h=function(e){return function(){s(c.filter((function(t){return t!==e})))}},O=f.length<2?[]:b.filter((function(e){return e.toLowerCase().includes(f.toLowerCase())&&!c.find((function(t){return t.toLowerCase()===e.toLowerCase()}))})).sort().slice(0,5);return Object(u.jsxs)("div",{className:"vertical gap-1 overflow-y-visible",children:[Object(u.jsx)("label",{htmlFor:r,children:a}),Object(u.jsx)("div",{className:"flex items-center gap-2 overflow-x-auto max-w-md",children:c.map((function(e){return Object(u.jsx)(P,{text:e,onDelete:h(e)},e)}))}),Object(u.jsx)("div",{ref:j,className:y()("relative inline-block rounded-lg bg-primary-500 p-4 horizontal overflow-x-auto overflow-y-hidden","gap-2"),children:Object(u.jsx)("input",{onKeyDown:function(e){"Enter"===e.key&&m(),"Backspace"===e.key&&0===f.length&&c.length>0&&h(c[c.length-1])()},className:"bg-primary-500 w-full outline-none text-xl h-4",value:f,onChange:function(e){return v(e.target.value)}})}),(null===O||void 0===O?void 0:O.length)>0&&Object(u.jsx)("div",{style:{top:null===j||void 0===j||null===(t=j.current)||void 0===t||null===(n=t.getBoundingClientRect())||void 0===n?void 0:n.bottom},className:"absolute min-h-20 bg-primary-500 rounded-lg left-0 right-0  z-20 max-h-32 mt-2 overflow-y-auto",children:O.map((function(e){return Object(u.jsx)("div",{onClick:function(){return m(e)},className:"cursor-pointer px-2 h-12 whitespace-nowrap overflow-ellipsis horizontal-center hover:bg-primary-700",children:e},e)}))})]})}var M=n(49),_=n(47),R=n(48);function A(){var e,t,n,r,a,c=o.a.useContext(O).store,s=null===c||void 0===c||null===(e=c.expenditures)||void 0===e?void 0:e.sort((function(e,t){return new Date(t.date).getTime()-new Date(e.date).getTime()})),i=new Date,l=Object(M.a)(i,1),d=null!==(t=null===(n=c.expenditures)||void 0===n?void 0:n.filter((function(e){return Object(_.a)(i,new Date(e.date))})).reduce((function(e,t){return e+t.amount}),0))&&void 0!==t?t:0,b=d-(null!==(r=null===(a=c.expenditures)||void 0===a?void 0:a.filter((function(e){return Object(_.a)(l,new Date(e.date))})).reduce((function(e,t){return e+t.amount}),0))&&void 0!==r?r:0);return Object(u.jsxs)("div",{className:"vertical flex-1 overflow-y-scroll",children:[Object(u.jsxs)("div",{className:"sticky top-0 h-16 flex-shrink-0 bg-primary-700 flex items-center justify-between",children:[Object(u.jsxs)("div",{className:"text-sm uppercase vertical text-green-500 font-bold",children:[Object(u.jsx)("span",{children:"Current month"}),Object(u.jsxs)("b",{className:"text-3xl text-green-400",children:[d.toFixed(2),"\u20ac"]})]}),Object(u.jsxs)("div",{className:y()("text-sm",b<=0?"text-green-500":"text-red-500"),children:[b<=0?"-":"+",Math.abs(b).toFixed(2),"\u20ac"]})]}),null===s||void 0===s?void 0:s.map((function(e){return Object(u.jsxs)("div",{className:"flex-shrink-0 items-center grid grid-cols-12 h-16 border-t border-b border-primary-200",children:[Object(u.jsx)("span",{className:"col-span-3",children:Object(R.a)(new Date(e.date),"yyyy-MM-dd HH:mm")}),Object(u.jsx)("span",{className:"col-span-6 whitespace-nowrap overflow-hidden overflow-ellipsis",children:e.description}),Object(u.jsxs)("span",{className:"col-span-3 whitespace-nowrap overflow-hidden overflow-ellipsis",children:[e.amount,"\u20ac"]})]})}))]})}var L=n(20),G=n.n(L),z=n(23),F=n(24),T=n.n(F);function H(e){var t=e.opened,n=e.onClose,r=o.a.useContext(O).store,a=function(){var e=Object(z.a)(G.a.mark((function e(t){var o,a;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=19;break}if((null===(o=JSON.parse(t))||void 0===o?void 0:o.url)&&(null===o||void 0===o?void 0:o.key)){e.next=4;break}throw new Error;case 4:return e.prev=4,e.next=7,fetch(o.url,{method:"POST",body:JSON.stringify(r)});case 7:return a=e.sent,e.next=10,a.json();case 10:e.sent,v.b.success("Code detected"),n(),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(4),console.log(e.t0),v.b.error(e.t0.message);case 19:case"end":return e.stop()}}),e,null,[[4,15]])})));return function(t){return e.apply(this,arguments)}}();return Object(u.jsxs)(N,{title:"Upload record",opened:t,onClose:n,children:[Object(u.jsx)("span",{className:"text-sm font-bold text-color-300 leading-4",children:"Upload expenditure records on this device to server by sending its QR code."}),Object(u.jsx)(T.a,{className:"mt-4 rounded-lg w-full overflow-hidden",onError:function(e){var t;v.b.error(null!==(t=null===e||void 0===e?void 0:e.message)&&void 0!==t?t:"Error with QR code")},onScan:a})]})}var I={amount:0,description:"",labels:[]};function J(){var e=o.a.useState(b.HOME_PAGE),t=Object(l.a)(e,2),n=t[0],r=t[1],a=o.a.useContext(O),c=a.addExpenditure,j=a.store,x=o.a.useState(I),p=Object(l.a)(x,2),f=p[0],m=p[1],h=o.a.useState(!1),g=Object(l.a)(h,2),w=g[0],y=g[1],N=j.expenditures.reduce((function(e,t){return Array.from(new Set([].concat(Object(i.a)(e),Object(i.a)(t.labels))))}),[]);return Object(u.jsxs)("div",{className:"absolute vertical inset-0 flex p-4 bg-primary-700 overflow-hidden",children:[Object(u.jsx)(v.a,{}),Object(u.jsx)(H,{opened:w,onClose:function(){return y(!1)}}),Object(u.jsx)(E,{currentPage:n,goPage:r}),n===b.HOME_PAGE&&Object(u.jsxs)("div",{className:"flex-1 vertical overflow-hidden",children:[Object(u.jsx)(d,{value:f.amount,onChange:function(e){return m(Object(s.a)(Object(s.a)({},f),{},{amount:e}))}}),Object(u.jsx)(k,{name:"description",label:"description",value:f.description,onChange:function(e){return m(Object(s.a)(Object(s.a)({},f),{},{description:e}))}}),Object(u.jsx)(D,{name:"labels",label:"tags",values:f.labels,onChange:function(e){return m(Object(s.a)(Object(s.a)({},f),{},{labels:e}))},selectableOptions:N}),Object(u.jsx)("div",{className:"flex-1"}),Object(u.jsx)(S,{onOpenUploadModal:function(){return y(!0)},onSubmit:function(){f.amount<=0||!f.description?v.b.error("missing description or amount is invalid."):(c(Object(s.a)(Object(s.a)({},f),{},{amount:f.amount/100,date:new Date,id:"".concat((new Date).getTime(),"-").concat(Math.random().toString().split(".")[1])})),m(I),v.b.success("Expenditure logged!"))}})]}),n===b.RECORD_LIST_PAGE&&Object(u.jsx)(A,{})]})}function B(){return Object(u.jsx)(g,{children:Object(u.jsx)(J,{})})}var U=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,50)).then((function(t){var n=t.getCLS,r=t.getFID,o=t.getFCP,a=t.getLCP,c=t.getTTFB;n(e),r(e),o(e),a(e),c(e)}))};c.a.render(Object(u.jsx)(o.a.StrictMode,{children:Object(u.jsx)(B,{})}),document.getElementById("root")),U()}},[[44,1,2]]]);
//# sourceMappingURL=main.680d98a2.chunk.js.map