(this["webpackJsonpexpenditure-notebook"]=this["webpackJsonpexpenditure-notebook"]||[]).push([[0],{30:function(e,t,n){},38:function(e,t,n){},44:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),c=n(21),o=n.n(c),s=(n(30),n(6)),i=n(13),l=n(10),u=n(0);function d(e){var t=e.value,n=e.onChange,r=a.a.useRef(null),c="".concat((t/100).toFixed(2),"\u20ac"),o=window.screen.width;return Object(u.jsx)("input",{ref:r,style:{fontSize:1.5*o/c.length},className:"digit center text-color-100 bg-primary-500 text-center",value:c,type:"tel",onKeyDown:function(e){var r=e.key,a=parseInt(r);Number.isNaN(a)||n(10*t+a),"Backspace"===r&&n(Math.floor(t/10))}})}var b,j=n(8),x=n(9);!function(e){e[e.HOME_PAGE=0]="HOME_PAGE",e[e.RECORD_LIST_PAGE=1]="RECORD_LIST_PAGE"}(b||(b={}));var p=n(22),f=n.n(p),m=n(11),v={expenditures:[]},h="ls/expenditure",O=a.a.createContext({store:v,addExpenditure:function(e){}});function g(e){var t=e.children,n=function(e){try{var t=JSON.parse(localStorage.getItem(h)||"")||v;return e?e.split(".").reduce((function(e,t){return null===e||void 0===e?void 0:e[t]}),t):t}catch(n){return null}}()||{expenditures:[]},r=a.a.useState(n),c=Object(l.a)(r,2),o=c[0],d=c[1];a.a.useEffect((function(){var e;o&&(e=o,localStorage.setItem(h,JSON.stringify(e)))}),[o]);var b={store:o,addExpenditure:function(e){d(Object(s.a)(Object(s.a)({},o),{},{expenditures:[].concat(Object(i.a)(o.expenditures),[e])}))}};return Object(u.jsx)(O.Provider,{value:b,children:t})}var w=n(12),N=n.n(w);function y(e){var t=e.children,n=e.title,r=e.opened,a=e.onClose,c=e.className;return r?Object(u.jsx)("div",{className:"fixed z-10 inset-0 p-4 center bg-color-700 bg-opacity-60",onClick:a,children:Object(u.jsxs)("div",{onClick:function(e){return e.stopPropagation()},className:N()("rounded-lg w-full bg-primary-300 text-color-100 vertical overflow-y-scroll",c||"h-2/3 p-2"),children:[Object(u.jsx)("span",{className:"uppercase font-bold text-md text-color-100 mb-2",children:n}),t]})}):null}function C(e){var t=e.opened,n=e.onClose,r=a.a.useContext(O).store;return Object(u.jsxs)(y,{title:"Copy store content to clipboard",opened:t,onClose:n,children:[Object(u.jsx)("textarea",{id:"store-text",className:"shadow-inner rounded-lg bg-primary-500 code digit flex-1 resize-none",value:JSON.stringify(r),contentEditable:!1}),Object(u.jsx)("div",{className:"h-16 py-2 flex items-center justify-end",children:Object(u.jsxs)("button",{type:"button",onClick:function(){f()(JSON.stringify(r)),m.b.success("Copied store value to clipboard!")},className:"rounded-lg bg-secondary-500 gap-2 flex items-center p-2 h-full hover:bg-secondary-600",children:[Object(u.jsx)(x.a,{icon:j.a}),"Copy to clipboard"]})})]})}function E(e){var t=e.currentPage,n=e.goPage,r=t===b.HOME_PAGE?b.RECORD_LIST_PAGE:b.HOME_PAGE,c=r===b.HOME_PAGE?j.b:j.c,o=a.a.useState(!1),s=Object(l.a)(o,2),i=s[0],d=s[1];return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)("header",{className:"h-16 flex-0 center relative",children:[Object(u.jsx)("span",{className:"uppercase text-lg",children:"Expenditure logbook"}),Object(u.jsxs)("div",{className:"absolute right-0 top-0 h-full horizontal-center gap-4 text-xl",children:[Object(u.jsx)(x.a,{icon:j.a,className:"cursor-pointer",onClick:function(){return d(!0)}}),Object(u.jsx)(x.a,{icon:c,onClick:function(){return n(r)},className:"cursor-pointer"})]})]}),Object(u.jsx)(C,{opened:i,onClose:function(){return d(!1)}})]})}n(38);function k(e){var t=e.children,n=e.className,r=e.name,a=e.label,c=e.value,o=e.onChange;return Object(u.jsxs)("div",{className:"vertical gap-1",children:[Object(u.jsx)("label",{htmlFor:r,children:a}),Object(u.jsxs)("div",{className:N()("rounded-lg bg-primary-200 p-4 horizontal",n),children:[t,Object(u.jsx)("input",{className:"bg-primary-200 w-full outline-none text-2xl",value:c,onChange:function(e){return o(e.target.value)}})]})]})}function S(e){var t=e.onOpenUploadModal,n=e.onSubmit;return Object(u.jsxs)("div",{className:"h-1/6 md:h-1/3 center w-full relative",children:[Object(u.jsx)("button",{onClick:n,className:"h-20 w-20 md:h-96 md:w-96 rounded-full bg-secondary-500 text-xl md:text-7xl",children:Object(u.jsx)(x.a,{icon:j.d})}),Object(u.jsx)("div",{className:"absolute right-0 top-0 h-full horizontal-center gap-2",children:Object(u.jsx)("button",{onClick:t,className:"text-3xl md:text-7xl rounded-full center h-12 w-12 bg-color-50 text-primary-500",children:Object(u.jsx)(x.a,{icon:j.e,className:"text-primary-500"})})})]})}function P(e){var t=e.text,n=e.onDelete;return Object(u.jsxs)("div",{onClick:n,className:"horizontal-center px-2 py-1 rounded-md bg-primary-100 text-sm text-color-100",children:[Object(u.jsx)("span",{className:"pr-1",children:t}),Object(u.jsx)(x.a,{icon:j.f,className:"pl-1 w-8 h-8"})]})}function D(e){var t=e.name,n=e.label,r=e.values,c=e.onChange,o=e.selectableOptions,s=void 0===o?[]:o,d=a.a.useState(""),b=Object(l.a)(d,2),j=b[0],x=b[1],p=function(e){var t=e||j;t&&(r.find((function(e){return e.toLowerCase()===t.toLowerCase()}))||(c([].concat(Object(i.a)(r),[t])),x("")))},f=function(e){return function(){c(r.filter((function(t){return t!==e})))}},m=j.length<2?[]:s.filter((function(e){return e.toLowerCase().includes(j.toLowerCase())&&!r.find((function(t){return t.toLowerCase()===e.toLowerCase()}))})).sort().slice(0,5);return Object(u.jsxs)("div",{className:"vertical gap-1",children:[Object(u.jsx)("label",{htmlFor:t,children:n}),Object(u.jsx)("div",{className:"flex items-center gap-2 overflow-x-auto max-w-md",children:r.reverse().map((function(e){return Object(u.jsx)(P,{text:e,onDelete:f(e)},e)}))}),Object(u.jsxs)("div",{className:N()("relative rounded-lg bg-primary-200 p-4 horizontal overflow-x-auto","gap-2"),children:[Object(u.jsx)("input",{onKeyDown:function(e){"Enter"===e.key&&p(),"Backspace"===e.key&&0===j.length&&r.length>0&&f(r[r.length-1])()},className:"bg-primary-200 w-full outline-none text-2xl",value:j,onChange:function(e){return x(e.target.value)}}),m&&Object(u.jsx)("div",{className:"absolute min-h-20 bg-primary-200 rounded-lg left-0 right-0 top-full mt-2 overflow-y-scroll",children:m.map((function(e){return Object(u.jsx)("div",{onClick:function(){return p(e)},className:"cursor-pointer px-2 h-12 whitespace-nowrap overflow-ellipsis horizontal-center hover:bg-primary-700",children:e},e)}))})]})]})}var _=n(49),M=n(47),A=n(48);function L(){var e,t,n,r,c,o=a.a.useContext(O).store,s=null===o||void 0===o||null===(e=o.expenditures)||void 0===e?void 0:e.sort((function(e,t){return new Date(t.date).getTime()-new Date(e.date).getTime()})),i=new Date,l=Object(_.a)(i,1),d=null!==(t=null===(n=o.expenditures)||void 0===n?void 0:n.filter((function(e){return Object(M.a)(i,new Date(e.date))})).reduce((function(e,t){return e+t.amount}),0))&&void 0!==t?t:0,b=d-(null!==(r=null===(c=o.expenditures)||void 0===c?void 0:c.filter((function(e){return Object(M.a)(l,new Date(e.date))})).reduce((function(e,t){return e+t.amount}),0))&&void 0!==r?r:0);return Object(u.jsxs)("div",{className:"vertical flex-1 overflow-y-scroll",children:[Object(u.jsxs)("div",{className:"sticky top-0 h-16 flex-shrink-0 bg-primary-500 flex items-center justify-between",children:[Object(u.jsxs)("div",{className:"text-sm uppercase vertical text-green-500 font-bold",children:[Object(u.jsx)("span",{children:"Current month"}),Object(u.jsxs)("b",{className:"text-3xl text-green-400",children:[d.toFixed(2),"\u20ac"]})]}),Object(u.jsxs)("div",{className:N()("text-sm",b<=0?"text-green-500":"text-red-500"),children:[b<=0?"-":"+",b.toFixed(2),"\u20ac"]})]}),null===s||void 0===s?void 0:s.map((function(e){return Object(u.jsxs)("div",{className:"flex-shrink-0 items-center grid grid-cols-12 h-16 border-t border-b border-primary-200",children:[Object(u.jsx)("span",{className:"col-span-3",children:Object(A.a)(new Date(e.date),"yyyy-MM-dd HH:mm")}),Object(u.jsx)("span",{className:"col-span-6 whitespace-nowrap overflow-hidden overflow-ellipsis",children:e.description}),Object(u.jsxs)("span",{className:"col-span-3 whitespace-nowrap overflow-hidden overflow-ellipsis",children:[e.amount,"\u20ac"]})]})}))]})}var G=n(20),R=n.n(G),F=n(23),T=n(24),z=n.n(T);function H(e){var t=e.opened,n=e.onClose,r=a.a.useContext(O).store,c=function(){var e=Object(F.a)(R.a.mark((function e(t){var a,c;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=19;break}if((null===(a=JSON.parse(t))||void 0===a?void 0:a.url)&&(null===a||void 0===a?void 0:a.key)){e.next=4;break}throw new Error;case 4:return e.prev=4,e.next=7,fetch(a.url,{method:"POST",body:JSON.stringify(r)});case 7:return c=e.sent,e.next=10,c.json();case 10:e.sent,m.b.success("Code detected"),n(),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(4),console.log(e.t0),m.b.error(e.t0.message);case 19:case"end":return e.stop()}}),e,null,[[4,15]])})));return function(t){return e.apply(this,arguments)}}();return Object(u.jsxs)(y,{title:"Upload record",opened:t,onClose:n,children:[Object(u.jsx)("span",{className:"text-sm font-bold text-color-300 leading-4",children:"Upload expenditure records on this device to server by sending its QR code."}),Object(u.jsx)(z.a,{className:"mt-4 rounded-lg w-full overflow-hidden",onError:function(e){var t;m.b.error(null!==(t=null===e||void 0===e?void 0:e.message)&&void 0!==t?t:"Error with QR code")},onScan:c})]})}var I={amount:0,description:"",labels:[]};function J(){var e=a.a.useState(b.HOME_PAGE),t=Object(l.a)(e,2),n=t[0],r=t[1],c=a.a.useContext(O),o=c.addExpenditure,j=c.store,x=a.a.useState(I),p=Object(l.a)(x,2),f=p[0],v=p[1],h=a.a.useState(!1),g=Object(l.a)(h,2),w=g[0],N=g[1],y=j.expenditures.reduce((function(e,t){return Array.from(new Set([].concat(Object(i.a)(e),Object(i.a)(t.labels))))}),[]);return Object(u.jsxs)("div",{className:"absolute vertical inset-0 flex p-4 bg-primary-500 overflow-hidden",children:[Object(u.jsx)(m.a,{}),Object(u.jsx)(H,{opened:w,onClose:function(){return N(!1)}}),Object(u.jsx)(E,{currentPage:n,goPage:r}),n===b.HOME_PAGE&&Object(u.jsxs)("div",{className:"flex-1 vertical overflow-hidden",children:[Object(u.jsx)(d,{value:f.amount,onChange:function(e){return v(Object(s.a)(Object(s.a)({},f),{},{amount:e}))}}),Object(u.jsx)(k,{name:"description",label:"description",value:f.description,onChange:function(e){return v(Object(s.a)(Object(s.a)({},f),{},{description:e}))}}),Object(u.jsx)(D,{name:"labels",label:"tags",values:f.labels,onChange:function(e){return v(Object(s.a)(Object(s.a)({},f),{},{labels:e}))},selectableOptions:y}),Object(u.jsx)("div",{className:"flex-1"}),Object(u.jsx)(S,{onOpenUploadModal:function(){return N(!0)},onSubmit:function(){f.amount<=0||!f.description?m.b.error("missing description or amount is invalid."):(o(Object(s.a)(Object(s.a)({},f),{},{amount:f.amount/100,date:new Date,id:"".concat((new Date).getTime(),"-").concat(Math.random().toString().split(".")[1])})),v(I),m.b.success("Expenditure logged!"))}})]}),n===b.RECORD_LIST_PAGE&&Object(u.jsx)(L,{})]})}function B(){return Object(u.jsx)(g,{children:Object(u.jsx)(J,{})})}var U=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,50)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),r(e),a(e),c(e),o(e)}))};o.a.render(Object(u.jsx)(a.a.StrictMode,{children:Object(u.jsx)(B,{})}),document.getElementById("root")),U()}},[[44,1,2]]]);
//# sourceMappingURL=main.a889ae83.chunk.js.map