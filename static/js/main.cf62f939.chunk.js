(this["webpackJsonpexpenditure-notebook"]=this["webpackJsonpexpenditure-notebook"]||[]).push([[0],{27:function(e,t,n){},35:function(e,t,n){},41:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),o=n(18),c=n.n(o),s=(n(27),n(3)),l=n(9),i=n(7),u=n(0);function d(e){var t=e.value,n=e.onChange,r=a.a.useRef(null),o="".concat((t/100).toFixed(2),"\u20ac"),c=window.screen.width;return Object(u.jsx)("input",{ref:r,style:{fontSize:1.5*c/o.length},className:"digit center text-color-100 bg-primary-500 text-center",value:o,type:"tel",onKeyDown:function(e){var r=e.key,a=parseInt(r);Number.isNaN(a)||n(10*t+a),"Backspace"===r&&n(Math.floor(t/10))}})}var b,j=n(5),p=n(6);!function(e){e[e.HOME_PAGE=0]="HOME_PAGE",e[e.RECORD_LIST_PAGE=1]="RECORD_LIST_PAGE"}(b||(b={}));var x=n(19),f=n.n(x),h=n(8),m={expenditures:[]},O="ls/expenditure",v=a.a.createContext({store:m,addExpenditure:function(e){}});function g(e){var t=e.children,n=function(e){try{var t=JSON.parse(localStorage.getItem(O)||"")||m;return e?e.split(".").reduce((function(e,t){return null===e||void 0===e?void 0:e[t]}),t):t}catch(n){return null}}()||{expenditures:[]},r=a.a.useState(n),o=Object(i.a)(r,2),c=o[0],d=o[1];a.a.useEffect((function(){var e;c&&(e=c,localStorage.setItem(O,JSON.stringify(e)))}),[c]);var b={store:c,addExpenditure:function(e){d(Object(s.a)(Object(s.a)({},c),{},{expenditures:[].concat(Object(l.a)(c.expenditures),[e])}))}};return Object(u.jsx)(v.Provider,{value:b,children:t})}var w=n(10),y=n.n(w);function N(e){var t=e.children,n=e.title,r=e.opened,a=e.onClose,o=e.className;return r?Object(u.jsx)("div",{className:"fixed z-10 inset-0 p-4 center bg-color-700 bg-opacity-60",onClick:a,children:Object(u.jsxs)("div",{onClick:function(e){return e.stopPropagation()},className:y()("rounded-lg w-full bg-primary-300 text-color-100 vertical overflow-y-scroll",o||"h-2/3 p-2"),children:[Object(u.jsx)("span",{className:"uppercase font-bold text-md text-color-100 mb-2",children:n}),t]})}):null}function C(e){var t=e.opened,n=e.onClose,r=a.a.useContext(v).store;return Object(u.jsxs)(N,{title:"Copy store content to clipboard",opened:t,onClose:n,children:[Object(u.jsx)("textarea",{id:"store-text",className:"shadow-inner rounded-lg bg-primary-500 code digit flex-1 resize-none",value:JSON.stringify(r),contentEditable:!1}),Object(u.jsx)("div",{className:"h-16 py-2 flex items-center justify-end",children:Object(u.jsxs)("button",{type:"button",onClick:function(){f()(JSON.stringify(r)),h.b.success("Copied store value to clipboard!")},className:"rounded-lg bg-secondary-500 gap-2 flex items-center p-2 h-full hover:bg-secondary-600",children:[Object(u.jsx)(p.a,{icon:j.a}),"Copy to clipboard"]})})]})}function E(e){var t=e.currentPage,n=e.goPage,r=t===b.HOME_PAGE?b.RECORD_LIST_PAGE:b.HOME_PAGE,o=r===b.HOME_PAGE?j.b:j.c,c=a.a.useState(!1),s=Object(i.a)(c,2),l=s[0],d=s[1];return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)("header",{className:"h-16 flex-0 center relative",children:[Object(u.jsx)("span",{className:"uppercase text-lg",children:"Expenditure logbook"}),Object(u.jsxs)("div",{className:"absolute right-0 top-0 h-full horizontal-center gap-4 text-xl",children:[Object(u.jsx)(p.a,{icon:j.a,className:"cursor-pointer",onClick:function(){return d(!0)}}),Object(u.jsx)(p.a,{icon:o,onClick:function(){return n(r)},className:"cursor-pointer"})]})]}),Object(u.jsx)(C,{opened:l,onClose:function(){return d(!1)}})]})}n(35);function S(e){var t=e.children,n=e.className,r=e.name,a=e.label,o=e.value,c=e.onChange;return Object(u.jsxs)("div",{className:"vertical gap-1",children:[Object(u.jsx)("label",{htmlFor:r,children:a}),Object(u.jsxs)("div",{className:y()("rounded-lg bg-primary-200 p-4 horizontal",n),children:[t,Object(u.jsx)("input",{className:"bg-primary-200 w-full outline-none text-2xl",value:o,onChange:function(e){return c(e.target.value)}})]})]})}function k(e){var t=e.onOpenUploadModal,n=e.onSubmit;return Object(u.jsxs)("div",{className:"h-1/6 md:h-1/3 center w-full relative",children:[Object(u.jsx)("button",{onClick:n,className:"h-20 w-20 md:h-96 md:w-96 rounded-full bg-secondary-500 text-xl md:text-7xl",children:Object(u.jsx)(p.a,{icon:j.d})}),Object(u.jsx)("div",{className:"absolute right-0 top-0 h-full horizontal-center gap-2",children:Object(u.jsx)("button",{onClick:t,className:"text-3xl md:text-7xl rounded-full center h-12 w-12 bg-color-50 text-primary-500",children:Object(u.jsx)(p.a,{icon:j.e,className:"text-primary-500"})})})]})}function P(e){var t=e.text,n=e.onDelete;return Object(u.jsxs)("div",{onClick:n,className:"horizontal-center px-2 py-1 rounded-md bg-primary-100 text-sm text-color-100",children:[Object(u.jsx)("span",{className:"pr-1",children:t}),Object(u.jsx)(p.a,{icon:j.f,className:"pl-1 w-8 h-8"})]})}function _(e){var t=e.name,n=e.label,r=e.values,o=e.onChange,c=e.selectableOptions,s=void 0===c?[]:c,d=a.a.useState(""),b=Object(i.a)(d,2),j=b[0],p=b[1],x=function(e){var t=e||j;t&&(r.find((function(e){return e.toLowerCase()===t.toLowerCase()}))||(o([].concat(Object(l.a)(r),[t])),p("")))},f=function(e){return function(){o(r.filter((function(t){return t!==e})))}},h=j.length<2?[]:s.filter((function(e){return e.toLowerCase().includes(j.toLowerCase())&&!r.find((function(t){return t.toLowerCase()===e.toLowerCase()}))})).sort().slice(0,5);return Object(u.jsxs)("div",{className:"vertical gap-1",children:[Object(u.jsx)("label",{htmlFor:t,children:n}),Object(u.jsxs)("div",{className:y()("relative rounded-lg bg-primary-200 p-4 horizontal","gap-2"),children:[r.map((function(e){return Object(u.jsx)(P,{text:e,onDelete:f(e)},e)})),Object(u.jsx)("input",{onKeyDown:function(e){"Enter"===e.key&&x(),"Backspace"===e.key&&0===j.length&&r.length>0&&f(r[r.length-1])()},className:"bg-primary-200 w-full outline-none text-2xl",value:j,onChange:function(e){return p(e.target.value)}}),h&&Object(u.jsx)("div",{className:"absolute min-h-20 bg-primary-200 rounded-lg left-0 right-0 top-full mt-2 overflow-y-scroll",children:h.map((function(e){return Object(u.jsx)("div",{onClick:function(){return x(e)},className:"cursor-pointer px-2 h-12 whitespace-nowrap overflow-ellipsis horizontal-center hover:bg-primary-700",children:e},e)}))})]})]})}var M=n(44);function A(){var e,t=a.a.useContext(v).store;return Object(u.jsx)("div",{className:"vertical flex-1 overflow-y-scroll",children:null===t||void 0===t||null===(e=t.expenditures)||void 0===e?void 0:e.map((function(e){return Object(u.jsxs)("div",{className:"flex-shrink-0 items-center grid grid-cols-12 h-16 border-t border-b border-primary-200",children:[Object(u.jsx)("span",{className:"col-span-3",children:Object(M.a)(new Date(e.date),"yyyy-MM-dd HH:mm")}),Object(u.jsx)("span",{className:"col-span-6 whitespace-nowrap overflow-hidden overflow-ellipsis",children:e.description}),Object(u.jsxs)("span",{className:"col-span-3 whitespace-nowrap overflow-hidden overflow-ellipsis",children:[e.amount,"\u20ac"]})]})}))})}var D=n(17),L=n.n(D),G=n(20),R=n(21),z=n.n(R);function H(e){var t=e.opened,n=e.onClose,r=a.a.useContext(v).store,o=function(){var e=Object(G.a)(L.a.mark((function e(t){var a,o;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=19;break}if((null===(a=JSON.parse(t))||void 0===a?void 0:a.url)&&(null===a||void 0===a?void 0:a.key)){e.next=4;break}throw new Error;case 4:return e.prev=4,e.next=7,fetch(a.url,{method:"POST",body:JSON.stringify(r)});case 7:return o=e.sent,e.next=10,o.json();case 10:e.sent,h.b.success("Code detected"),n(),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(4),console.log(e.t0),h.b.error(e.t0.message);case 19:case"end":return e.stop()}}),e,null,[[4,15]])})));return function(t){return e.apply(this,arguments)}}();return Object(u.jsxs)(N,{title:"Upload record",opened:t,onClose:n,children:[Object(u.jsx)("span",{className:"text-sm font-bold text-color-300 leading-4",children:"Upload expenditure records on this device to server by sending its QR code."}),Object(u.jsx)(z.a,{className:"mt-4 rounded-lg w-full overflow-hidden",onError:function(e){var t;h.b.error(null!==(t=null===e||void 0===e?void 0:e.message)&&void 0!==t?t:"Error with QR code")},onScan:o})]})}var I={amount:0,description:"",labels:[]};function F(){var e=a.a.useState(b.HOME_PAGE),t=Object(i.a)(e,2),n=t[0],r=t[1],o=a.a.useContext(v),c=o.addExpenditure,j=o.store,p=a.a.useState(I),x=Object(i.a)(p,2),f=x[0],m=x[1],O=a.a.useState(!1),g=Object(i.a)(O,2),w=g[0],y=g[1],N=j.expenditures.reduce((function(e,t){return Array.from(new Set([].concat(Object(l.a)(e),Object(l.a)(t.labels))))}),[]);return Object(u.jsxs)("div",{className:"absolute vertical inset-0 flex p-4 bg-primary-500 overflow-hidden",children:[Object(u.jsx)(h.a,{}),Object(u.jsx)(H,{opened:w,onClose:function(){return y(!1)}}),Object(u.jsx)(E,{currentPage:n,goPage:r}),n===b.HOME_PAGE&&Object(u.jsxs)("div",{className:"flex-1 vertical overflow-hidden",children:[Object(u.jsx)(d,{value:f.amount,onChange:function(e){return m(Object(s.a)(Object(s.a)({},f),{},{amount:e}))}}),Object(u.jsx)(S,{name:"description",label:"description",value:f.description,onChange:function(e){return m(Object(s.a)(Object(s.a)({},f),{},{description:e}))}}),Object(u.jsx)(_,{name:"labels",label:"tags",values:f.labels,onChange:function(e){return m(Object(s.a)(Object(s.a)({},f),{},{labels:e}))},selectableOptions:N}),Object(u.jsx)("div",{className:"flex-1"}),Object(u.jsx)(k,{onOpenUploadModal:function(){return y(!0)},onSubmit:function(){f.amount<=0||!f.description?h.b.error("missing description or amount is invalid."):(c(Object(s.a)(Object(s.a)({},f),{},{amount:f.amount/100,date:new Date,id:"".concat((new Date).getTime(),"-").concat(Math.random().toString().split(".")[1])})),m(I),h.b.success("Expenditure logged!"))}})]}),n===b.RECORD_LIST_PAGE&&Object(u.jsx)(A,{})]})}function J(){return Object(u.jsx)(g,{children:Object(u.jsx)(F,{})})}var T=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,45)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,o=t.getLCP,c=t.getTTFB;n(e),r(e),a(e),o(e),c(e)}))};c.a.render(Object(u.jsx)(a.a.StrictMode,{children:Object(u.jsx)(J,{})}),document.getElementById("root")),T()}},[[41,1,2]]]);
//# sourceMappingURL=main.cf62f939.chunk.js.map